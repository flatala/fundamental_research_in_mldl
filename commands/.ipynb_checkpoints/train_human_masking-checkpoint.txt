
TUNE THE BASELINE NOT TRAINED ON SPLIT 1 ON SPLIT 2

python train.py \
--video_path datasets/UCF-101-JPG \
--is_place_adv \
--annotation_path datasets/ucfTrainTestlist/ucf101_01.json \
--result_path models/human_masking_25_epochs_standard_final_masks_fixed \
--root_path /workspace \
--dataset ucf101_adv_msk \
--n_classes 101 \
--n_finetune_classes 101 \
--model resnet \
--model_depth 18 \
--resnet_shortcut A \
--batch_size 256 \
--val_batch_size 16 \
--n_threads 16 \
--checkpoint 1 \
--ft_begin_index 0 \
--num_place_hidden_layers 3 \
--num_human_mask_adv_hidden_layers 1 \
--new_layer_lr 1e-4 \
--learning_rate 0.0032 \
--warm_up_epochs 0 \
--weight_decay 1e-5 \
--n_epochs 25 \
--place_pred_path /workspace/datasets/scene_labels_resnet/ \
--is_mask_entropy \
--alpha 0.5 \
--mask_ratio 1.0 \
--slower_place_mlp \
--not_replace_last_fc \
--num_places_classes 365 \
--human_dets_path /workspace/datasets/human_detections_final/ \
--pretrain_path models/transfer_learning/ucf101/3d-resnet-18_ucf101_split1_baseline.pth

python train.py \
--video_path datasets/UCF-101-JPG \
--is_place_adv \
--annotation_path datasets/ucfTrainTestlist/ucf101_01.json \
--result_path models/human_masking_25_epochs_rand_final_masks_fixed \
--root_path /workspace \
--dataset ucf101_adv_msk \
--n_classes 101 \
--n_finetune_classes 101 \
--model resnet \
--model_depth 18 \
--resnet_shortcut A \
--batch_size 256 \
--val_batch_size 16 \
--n_threads 16 \
--checkpoint 1 \
--ft_begin_index 0 \
--num_place_hidden_layers 3 \
--num_human_mask_adv_hidden_layers 1 \
--new_layer_lr 1e-4 \
--learning_rate 0.0032 \
--warm_up_epochs 0 \
--weight_decay 1e-5 \
--n_epochs 25 \
--place_pred_path /workspace/datasets/scene_labels_resnet/ \
--is_mask_entropy \
--alpha 0.5 \
--mask_ratio 1.0 \
--slower_place_mlp \
--not_replace_last_fc \
--num_places_classes 365 \
--human_dets_path /workspace/datasets/human_detections_rand/ \
--pretrain_path models/transfer_learning/ucf101/3d-resnet-18_ucf101_split1_baseline.pth

TEST ON SPLIT 1:

python train.py \
--no_train \
--is_mask_adv \
--no_val \
--video_path datasets/UCF-101-JPG \
--annotation_path datasets/ucfTrainTestlist/ucf101_01.json \
--result_path models/test_runs_human_masking/test_human_masking_randomised \
--root_path /workspace \
--dataset ucf101 \
--n_classes 101 \
--n_finetune_classes 101 \
--model resnet \
--model_depth 18 \
--resnet_shortcut A \
--batch_size 256 \
--val_batch_size 16 \
--n_threads 16 \
--checkpoint 1 \
--ft_begin_index 0 \
--num_place_hidden_layers 3 \
--num_human_mask_adv_hidden_layers 1 \
--new_layer_lr 1e-4 \
--learning_rate 0.0032 \
--warm_up_epochs 0 \
--weight_decay 1e-5 \
--n_epochs 25 \
--place_pred_path /workspace/datasets/scene_labels_resnet/ \
--test \
--is_place_adv \
--is_mask_entropy \
--alpha 0.5 \
--mask_ratio 1.0 \
--slower_place_mlp \
--not_replace_last_fc \
--num_places_classes 365 \
--human_dets_path /workspace/datasets/human_detections_final/ \
--pretrain_path models/human_masking_25_epochs_rand_final_masks_fixed/save_25.pth

models/human_masking_50_epochs_standard_rand_masks/save_25.pth
models/human_masking_50_epochs_standard_final_masks/save_25.pth

CALCULATE ACCURACY:

root@06bb45684c3d:/workspace/SDN# python -m utils.eval_ucf101 \
    --annotation_path /workspace/datasets/ucfTrainTestlist/ucf101_01.json \
    --prediction_path /workspace/models/test_runs_human_masking/test_human_masking_randomised/val.json


